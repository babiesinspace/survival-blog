<div class="container">
  <blockquote>
    <h1><%= @post.title %></h1>
    <p><%= @post.body %></p>
  </blockquote>
  <form action="/posts/<%= @post.id %>/like" method="POST">
    <span class="badge badge-primary badge-pill"><%= @post.likes.count %>  </span>  <button type="submit">Like</button>
  </form>

  <% if @user && @post.author == @user %>
    <form action="/posts/<%=@post.id%>/edit" method="POST">
      <input type="hidden" name="_method" value="PUT">
      <div class="form-row">
        <div class="form-group">
          <label for="title">Title</label>
          <input class="form-control" type="text" name="title" placeholder="<%= @post.title%>"></input>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="body">Body</label>
          <textarea class="form-control" name="body" rows="10" placeholder="<%= @post.body%>"></textarea>
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Update</button>
    </form>

    <form action="/posts/<%= @post.id %>" method="POST">
      <input type="hidden" name="_method" value="DELETE">
      <button type="submit">Delete</button>
    </form>
  <% end %>

  <% @post.comments.each do |comment| %>
    <div class="container">
      <p><%= comment.content %> <strong><%= comment.author.handle %></strong></p>
      <form action="/posts/<%= @post.id %>/comments/<%= comment.id %>/like" method="POST">
        <input type="hidden" name="likable_id" value=<%= comment.id %>>
        <span class="badge badge-primary badge-pill"><%= comment.likes.count %>  </span>  <button type="submit">Like</button>
      </form>

      <% if @user && comment.author == @user %>
        <form action="/comments/<%=comment.id%>/edit" method="POST">
          <input type="hidden" name="_method" value="PUT">
          <input type="hidden" name="post" value="<%= @post.id %>">
          <div class="form-row">
            <div class="form-group">
              <label for="exampleFormControlTextarea1">You Wrote:</label>
              <textarea class="form-control" name="content" rows="3" placeholder="<%= comment.content%>"></textarea>
            </div>
          </div>
          <button type="submit" class="btn btn-primary">Update</button>
        </form>

        <form action="/comments/<%= comment.id %>" method="POST">
          <input type="hidden" name="_method" value="DELETE">
          <input type="hidden" name="post" value="<%= @post.id %>">
          <button type="submit">Delete</button>
        </form>
      <% else %>
        <form action="/comments/<%=comment.id%>/new" method="POST">
          <div class="form-row">
            <div class="form-group">
              <label for="exampleFormControlTextarea1">Add Comment:</label>
              <textarea class="form-control" name="content" rows="3" ></textarea>
            </div>
          </div>
          <button type="submit" class="btn btn-primary">Add</button>
        </form>
      <% end %>  

    </div>
  <% end %>
  <% if @user %>
    <form action="/posts/<%=@post.id%>/comments/new" method="POST">
      <div class="form-row">
        <div class="form-group">
          <label for="content">Add Comment:</label>
          <textarea class="form-control" name="content" rows="3" ></textarea>
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Add</button>
    </form>
  <% else %>
    <p><em>Sign in or register to leave a comment!</em></p>
  <% end %>
</div>